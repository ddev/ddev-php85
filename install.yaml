name: php85

project_files:
  - docker-compose.php85.yaml
  - nginx_full/nginx-php85.conf
  - web-entrypoint.d/php85.sh
  - php85-build/Dockerfile
  - config.php85.yaml
  - php/php-nowarnings.ini
  - commands/php85/php85
  - commands/php85/composer85
  - commands/php85/drush85

ddev_version_constraint: '>= v1.24.8'

post_install_actions:
  - |
    #ddev-description:Configure nginx docroot for PHP 8.5 service
    if [ -n "${DDEV_DOCROOT}" ]; then
      sed -i.bak "s|__DDEV_DOCROOT__|${DDEV_DOCROOT}|g" ${DDEV_APPROOT}/.ddev/nginx_full/nginx-php85.conf
    else
      sed -i.bak "s|__DDEV_DOCROOT__||g" ${DDEV_APPROOT}/.ddev/nginx_full/nginx-php85.conf
    fi
    rm -f ${DDEV_APPROOT}/.ddev/nginx_full/nginx-php85.conf.bak

